---
title: "DEEB Data -- Plots"
date: "`r format(Sys.Date())`"
output: 
  html_document:
    toc: no
    toc_depth: 6
    number_sections: no
    self_contained: false
params:
  plotsDir: "~/DEEBDB9/lotkaVolterra/plots"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(tidyverse.quiet = TRUE)
library(tidyverse)
```

```{r, include=FALSE}
pattern <- "Truth(\\d+)Obs(\\d+)(\\w+)\\.png"
fileMatrix <- 
  params$plotsDir |> 
  dir() |> 
  str_subset(pattern) |> 
  str_match(pattern)
colnames(fileMatrix) <- c("fileName", "truthNr", "obsNr", "kind")
truthObsPlots <- 
  as_tibble(fileMatrix) |> 
  mutate(across(ends_with("Nr"), as.integer)) |> 
  mutate(path = normalizePath(file.path(params$plotsDir, .data$fileName), mustWork=TRUE))
```

```{r, include=FALSE}
pattern <- "Truth(\\d+)Task(\\d+)(\\w+)\\.png"
fileMatrix <- 
  params$plotsDir |> 
  dir() |> 
  str_subset(pattern) |> 
  str_match(pattern)
colnames(fileMatrix) <- c("fileName", "truthNr", "taskNr", "kind")
truthTaskPlots <- 
  as_tibble(fileMatrix) |> 
  mutate(across(ends_with("Nr"), as.integer)) |> 
  mutate(path = normalizePath(file.path(params$plotsDir, .data$fileName), mustWork=TRUE))
```



# Observation  {.tabset}

```{r results='asis', fig.show='asis'}
for (knd in unique(truthObsPlots$kind)) {
  cat("##", knd, " {.tabset}\n\n")
  kindPlots <- filter(truthObsPlots, kind == knd)
  for (thnr in sort(unique(kindPlots$truthNr))) {
    truthPlots <- filter(kindPlots, truthNr == thnr)
    cat(paste(paste0("![](", truthPlots$path, "){width=", min(40, 100/(length(truthPlots$path))-1),"%}"), collapse="\n"), "\n\n") 
  }
  cat("\n\n")
}
```


# Tasks  {.tabset}

```{r results='asis', fig.show='asis'}
for (tnr in unique(truthTaskPlots$taskNr)) {
  cat("## Task ", tnr, " {.tabset}\n\n")
  taskPlots <- filter(truthTaskPlots, taskNr == tnr)
  for (thnr in sort(unique(taskPlots$truthNr))) {
    truthPlots <- filter(taskPlots, truthNr == thnr)
    cat(paste(paste0("![](", truthPlots$path, "){width=", min(40, 100/(length(truthPlots$path))-1),"%}"), collapse="\n"), "\n\n") 
  }
  cat("\n\n")
}
```


